<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/estilo.css">
    <title>Jogos Retro - Quiz</title>
</head>

<body alt="Imagem de fundo: consoles antigos de videogame (Reprodução: @robtek/Shutterstock)">
    <div class="ret_principal">
        <div id="ret_superior">
            <p class="titulo_geral">Jogos Retrô</p>
            <p class="subtitulo_geral">Quiz</p>
            <p class="subtitulo_geral">Qual game retrô mais combina com seu perfil?</p>
            <span class="linha"></span>
            <p id="cumprimento">Obrigado por realizar este quiz, divirta-se</p>
        </div>

        <div class="pergunta">
            <div class="numeracao">1.</div>
            <p class="texto_pergunta">Para você, qual experiência um jogo deve priorizar?</p>
            <form id="pergunta1" class="opcoes">
                <span class="opcao"><input type="radio" name="p1" value="Uma história envolvente">
                    <span>Uma história envolvente</span></span>
                <span class="opcao"><input type="radio" name="p1" value="Uma jogabilidade divertida">
                    <span>Uma jogabilidade divertida</span></span>
                <span class="opcao"><input type="radio" name="p1" value="Um visual interessante">
                    <span>Um visual interessante</span></span>
                <span class="opcao"><input type="radio" name="p1" value="Uma atmosfera imersiva">
                    <span>Uma atmosfera imersiva</span></span>
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/sotnGif.gif" alt="gif"
                    title="Gif de Castlevania: Symphony of the Night, © Konami, 1997.">
            </div>
        </div>
        <span class="linha"></span>

        <div class="pergunta">
            <div class="numeracao">2.</div>
            <p class="texto_pergunta">Qual nível de dificuldade um bom jogo deve possuir?</p>
            <form id="pergunta2" class="opcoes">
                <span class="opcao"><input type="radio" name="p2" value="Causal – Sem foco em desafios">
                    <span>Causal – Sem foco em desafios</span></span>
                <span class="opcao"><input type="radio" name="p2" value="Fácil - Pouco desafiador">
                    <span>Fácil - Pouco desafiador</span></span>
                <span class="opcao"><input type="radio" name="p2" value="Normal - Com desafios esporádicos">
                    <span>Normal - Com desafios esporádicos</span></span>
                <span class="opcao"><input type="radio" name="p2" value="Difícil - Desafios constantes">
                    <span>Difícil - Desafios constantes</span></span>
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/ctGif.gif" alt="gif"
                    title="Gif de Chrono Trigger, © Square Co., Ltd., 1995.">
            </div>
        </div>
        <span class="linha"></span>

        <div class="pergunta">
            <div class="numeracao">3.</div>
            <p class="texto_pergunta">Você joga no celular sem nenhum acessório?</p>
            <form id="pergunta3" class="opcoes">
                <span class="opcao"><input type="radio" name="p3" value="Sim">
                    <span>Sim</span></span>
                <span class="opcao"><input type="radio" name="p3" value="Não">
                    <span>Não</span></span>
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/fnftGif.gif" alt="gif"
                    title="Gif de Final Fantasy Tactics: The War of the Lions, © Square Enix Co., Ltd., 2007.">
            </div>
        </div>
        <span class="linha"></span>

        <div class="pergunta">
            <div class="numeracao">4.</div>
            <p class="texto_pergunta">O que você NÃO gosta em jogos?</p>
            <form id="pergunta4" class="opcoes">
                <span class="opcao"><input type="radio" name="p4" value="Violência">
                    <span>Violência</span></span>
                <span class="opcao"><input type="radio" name="p4" value="Jogabilidade Complexa">
                    <span>Jogabilidade Complexa</span></span>
                <span class="opcao"><input type="radio" name="p4" value="História fraca">
                    <span>História fraca</span></span>
                <span class="opcao"><input type="radio" name="p4" value="Repetição">
                    <span>Repetição</span></span>
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/re2Gif.gif" alt="gif" title="Gif de Resident Evil 2, © Capcom, 1998.">
            </div>
        </div>
        <span class="linha"></span>

        <div class="pergunta">
            <div class="numeracao">5.</div>
            <p class="texto_pergunta">Gráficos 3D antigos te incomodam?</p>
            <form id="pergunta5" class="opcoes">
                <span class="opcao"><input type="radio" name="p5" value="Sim">
                    <span>Sim</span></span>
                <span class="opcao"><input type="radio" name="p5" value="Não">
                    <span>Não</span></span>
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/oftGif.gif" alt="gif"
                    title="Gif de The Legend of Zelda: Ocarina of Time, © Nintendo, 1998.">
            </div>
        </div>
        <span class="linha"></span>

        <div class="pergunta">
            <div class="numeracao">6.</div>
            <p class="texto_pergunta">Quanta experiência você tem com jogos no geral?</p>
            <form id="pergunta6" class="opcoes">
                <span class="opcao"><input type="radio" name="p6" value="Quase nenhuma experiência">
                    <span>Quase nenhuma experiência</span></span>
                <span class="opcao"><input type="radio" name="p6" value="Pouca experiência">
                    <span>Pouca experiência</span></span>
                <span class="opcao"><input type="radio" name="p6" value="Experiência considerável">
                    <span>Experiência considerável</span></span>
                <span class="opcao"><input type="radio" name="p6" value="Muita experiência">
                    <span>Muita experiência</span></span> 
            </form>
        </div>
        <div class="comentario">
            <div class="caixa_comentario">
                <img class="gifJogos" src="assets/gifs/mmxGif.gif" alt="gif" title="Gif de Mega Man X, © Capcom, 1993.">
            </div>
        </div>
        <span class="linha"></span>

        <button onclick="recomendar()" id="but_enviar">Enviar Respostas</button>
    </div>
</body>
<script>
    if (sessionStorage.getItem('nome') && sessionStorage.getItem('acessos')) {
        cumprimento.innerHTML = `Parabéns, ${sessionStorage.getItem('nome')}, você é a ${sessionStorage.getItem('acessos')}° Pessoa a iniciar este quiz!`
    }

    var js_jogos = [1, 2, 3, 4, 5, 6];
    var js_pontos = [0, 0, 0, 0, 0, 0];
    var jogoRecomendado = '';
    var usuario = sessionStorage.getItem('acessos');

    function recomendar() {

        var r1 = pergunta1.p1.value;
        var r2 = pergunta2.p2.value;
        var r3 = pergunta3.p3.value;
        var r4 = pergunta4.p4.value;
        var r5 = pergunta5.p5.value;
        var r6 = pergunta6.p6.value;
        var pontos_ganhador = 0;
        var codigo = sessionStorage.getItem('acessos');

        //Pergunta 1
        if (r1 == 'Uma história envolvente') {
            js_pontos[0] += 1;
            js_pontos[1] += 1;
            js_pontos[2] += 3;
            js_pontos[3] += 2;
            js_pontos[4] += 2;
            js_pontos[5] += 2;
        }
        else if (r1 == 'Uma jogabilidade divertida') {
            js_pontos[0] += 3;
            js_pontos[1] += 3;
            js_pontos[2] += 3;
            js_pontos[3] += 3;
            js_pontos[4] += 0;
            js_pontos[5] += 3;
        }
        else if (r1 == 'Um visual interessante') {
            js_pontos[0] += 3;
            js_pontos[1] += 2;
            js_pontos[2] += 3;
            js_pontos[3] += 1;
            js_pontos[4] += 1;
            js_pontos[5] += 2;
        }
        else if (r1 == 'Uma atmosfera imersiva') {
            js_pontos[0] += 2;
            js_pontos[1] += 1;
            js_pontos[2] += 3;
            js_pontos[3] += 2;
            js_pontos[4] += 3;
            js_pontos[5] += 2;
        }
        else {
            alert('Responda a pergunta 1, para enviar suas respostas')
            return;
        }

        //Pergunta 2
        if (r2 == 'Causal – Sem foco em desafios') {
            js_pontos[0] += 0;
            js_pontos[1] -= 1;
            js_pontos[2] -= 3;
            js_pontos[3] += 0;
            js_pontos[4] -= 3;
            js_pontos[5] += 3;
        }
        else if (r2 == 'Fácil - Pouco desafiador') {
            js_pontos[0] += 2;
            js_pontos[1] += 0;
            js_pontos[2] -= 3;
            js_pontos[3] += 2;
            js_pontos[4] -= 3;
            js_pontos[5] += 3;
        }
        else if (r2 == 'Normal - Com desafios esporádicos') {
            js_pontos[0] += 2;
            js_pontos[1] += 1;
            js_pontos[2] -= 1;
            js_pontos[3] += 3;
            js_pontos[4] += 1;
            js_pontos[5] += 1;
        }
        else if (r2 == 'Difícil - Desafios constantes') {
            js_pontos[0] += 0;
            js_pontos[1] += 2;
            js_pontos[2] += 3;
            js_pontos[3] += 0;
            js_pontos[4] += 3;
            js_pontos[5] -= 3;
        }
        else {
            alert('Responda a pergunta 2, para enviar suas respostas');
            return;
        }

        //Pergunta 3
        if (r3 == 'Sim') {
            js_pontos[0] += 3;
            js_pontos[1] -= 3;
            js_pontos[2] += 3;
            js_pontos[3] -= 3;
            js_pontos[4] -= 3;
            js_pontos[5] += 3;
        }
        else if (r3 == 'Não') {
            js_pontos[0] += 0;
            js_pontos[1] += 0;
            js_pontos[2] += 0;
            js_pontos[3] += 0;
            js_pontos[4] += 1;
            js_pontos[5] += 0;
        }
        else {
            alert('Responda a pergunta 3, para enviar suas respostas')
            return;
        }

        //Pergunta 4
        if (r4 == 'Violência') {
            js_pontos[0] -= 2;
            js_pontos[1] -= 0;
            js_pontos[2] -= 0;
            js_pontos[3] -= 0;
            js_pontos[4] -= 3;
            js_pontos[5] -= 0;
        }
        else if (r4 == 'Jogabilidade Complexa') {
            js_pontos[0] -= 0;
            js_pontos[1] -= 0;
            js_pontos[2] -= 3;
            js_pontos[3] -= 1;
            js_pontos[4] -= 3;
            js_pontos[5] -= 0;
        }
        else if (r4 == 'História fraca') {
            js_pontos[0] -= 3;
            js_pontos[1] -= 3;
            js_pontos[2] -= 0;
            js_pontos[3] -= 0;
            js_pontos[4] -= 0;
            js_pontos[5] -= 0;
        }
        else if (r4 == 'Repetição') {
            js_pontos[0] -= 2;
            js_pontos[1] -= 0;
            js_pontos[2] -= 2;
            js_pontos[3] -= 1;
            js_pontos[4] -= 0;
            js_pontos[5] -= 1;
        }
        else {
            alert('Responda a pergunta 4, para enviar suas respostas')
            return;
        }

        //Pergunta 5
        if (r5 == 'Sim') {
            js_pontos[0] += 0;
            js_pontos[1] += 0;
            js_pontos[2] += 0;
            js_pontos[3] -= 3;
            js_pontos[4] -= 3;
            js_pontos[5] += 0;
        }
        else if (r5 == 'Não') {
            js_pontos[0] += 0;
            js_pontos[1] += 0;
            js_pontos[2] += 0;
            js_pontos[3] += 1;
            js_pontos[4] += 1;
            js_pontos[5] += 0;
        }
        else {
            alert('Responda a pergunta 5, para enviar suas respostas');
            return;
        }

        //Pergunta 6
        if (r6 == 'Quase nenhuma experiência') {
            js_pontos[0] += 1;
            js_pontos[1] += 1;
            js_pontos[2] -= 3;
            js_pontos[3] += 1;
            js_pontos[4] -= 3;
            js_pontos[5] += 3;
        }
        else if (r6 == 'Pouca experiência') {
            js_pontos[0] += 2;
            js_pontos[1] += 2;
            js_pontos[2] -= 2;
            js_pontos[3] += 2;
            js_pontos[4] -= 2;
            js_pontos[5] += 3;
        }
        else if (r6 == 'Experiência considerável') {
            js_pontos[0] += 3;
            js_pontos[1] += 3;
            js_pontos[2] += 1;
            js_pontos[3] += 3;
            js_pontos[4] += 1;
            js_pontos[5] += 2;
        }
        else if (r6 == 'Muita experiência') {
            js_pontos[0] += 2;
            js_pontos[1] += 2;
            js_pontos[2] += 3;
            js_pontos[3] += 2;
            js_pontos[4] += 3;
            js_pontos[5] += 2;

        }
        else {
            alert('Responda a pergunta 6, para enviar suas respostas')
            return;
        }

        for (let index = 0; index < js_pontos.length; index++) {
            if (js_pontos[index] > pontos_ganhador) {
                pontos_ganhador = js_pontos[index];
            }
        }

        but_enviar.onclick = "";
        var js_caracteres = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*-+=';//caracteres para o código

        for (let i = 1; i <= 6; i++) {
            codigo += js_caracteres[(Math.random() * (js_caracteres.length - 1)).toFixed(0)];
        }

        jogoRecomendado = js_jogos[js_pontos.indexOf(pontos_ganhador)];
        sessionStorage.setItem('recomendacao', jogoRecomendado);
        sessionStorage.setItem('codigo', codigo);


        fetch("/respostas/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                r1Server: r1,
                r2Server: r2,
                r3Server: r3,
                r4Server: r4,
                r5Server: r5,
                r6Server: r6,
                codigoServer: codigo,
                jrServer: jogoRecomendado,
                usuarioServer: usuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {
                    setTimeout(() => {
                        window.location = "recomendacao.html";
                    }, "500");
                } else {
                    throw "Houve um erro ao tentar realizar o cadastro do quiz!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });
    }
</script>

</html>
